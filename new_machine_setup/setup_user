#!/usr/bin/env bash

set -euo pipefail

if [[ "$#" -ne 1 ]]; then
	echo "Usage: user_setup user_name"
	exit 1
fi

if [[ ! -f /etc/os-release ]]; then
	echo "Works on Fedora only"
	exit 1
fi

if ! grep -iq '^ID=fedora$' "/etc/os-release"; then
	echo "Works on Fedora only"
	exit 1
fi

new_user="${1}"
sudo useradd -m -G wheel -s /bin/bash "${new_user}"
sudo passwd "${new_user}"
echo "Logging in as ${new_user}"
su - "${new_user}"
