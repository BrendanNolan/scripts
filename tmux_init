#!/usr/bin/env python3

import json
import sys
import os

if len(sys.argv) != 2:
    print(f"Usage: {sys.argv[0]} <json_file_specifying_tmux_sessions_and_windows>")
    sys.exit(1)

with open(sys.argv[1], 'r') as f:
    data = json.load(f)

for entry in data:
    session = entry.get("session", "")
    assert session
    window_dirs = entry["window_dirs"]
    assert window_dirs
    first_dir = window_dirs[0]
    os.system(f"tmux new-session -d -s {session} -c {first_dir}")
    for dir in window_dirs[1:]:
        os.system(f"tmux new-window -t {session}: -c {dir}")

os.system("tmux attach")

# Example JSON file:
# [
#   {
#     "session": "alpha",
#     "window_dirs": ["/home/user1", "/var/log"]
#   },
#   {
#     "session": "beta",
#     "window_dirs": ["/usr", "/bin"]
#   }
# ]

